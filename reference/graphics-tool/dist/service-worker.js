(()=>{var l=0,s=new Map,i=new BroadcastChannel("intercept-channel-main"),u=new BroadcastChannel("intercept-channel-sw");u.onmessage=n=>{let e=n.data;if(e&&e.reply!==void 0){let r=s.get(e.reply);r&&(s.delete(e.reply),e.error?r.reject(e.error):r.resolve(e.result))}};self.addEventListener("fetch",function(n){let e=n.request.url,r=e,a=e.match(/(LOCAL)(\/.*)/i);a?n.respondWith(new Promise((t,c)=>{let o=l++;s.set(o,{resolve:t,reject:c}),i.postMessage({type:"fetch",id:o,url:a[2]})}).then(t=>t==="NotFoundError"?new Response(null,{status:404,statusText:"File not found"}):new Response(t.arrayBuffer,{headers:{"Content-Type":t.type,"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}})).catch(t=>new Response(null,{status:500,statusText:`Error when intercepting request: ${t}`}))):n.respondWith(fetch(r))});})();
